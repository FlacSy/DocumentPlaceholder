<div align="center">

  # üìÑ DocumentPlaceholder

  **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ Word-—à–∞–±–ª–æ–Ω–æ–≤ —Å –ø–æ–º–æ—â—å—é YAML-–∫–æ–Ω—Ñ–∏–≥–æ–≤, –≤—ã—Ä–∞–∂–µ–Ω–∏–π –∏ SQL.**

  *–°–æ–∑–¥–∞–≤–∞–π—Ç–µ —Å—á–µ—Ç–∞, –∞–∫—Ç—ã, –æ—Ç—á—ë—Ç—ã –∏ –ª—é–±—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã ‚Äî –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π.*

  [![PyPI Version](https://img.shields.io/pypi/v/document-placeholder?style=flat-square&color=blue)](https://pypi.org/project/document-placeholder/)
  [![Python Versions](https://img.shields.io/pypi/pyversions/document-placeholder?style=flat-square)](https://pypi.org/project/document-placeholder/)
  [![License](https://img.shields.io/pypi/l/document-placeholder?style=flat-square)](https://opensource.org/licenses/MIT)
  [![Tests](https://img.shields.io/badge/tests-295%20passed-brightgreen?style=flat-square)]()

  [–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏](#-–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏) ‚Ä¢ [–£—Å—Ç–∞–Ω–æ–≤–∫–∞](#-—É—Å—Ç–∞–Ω–æ–≤–∫–∞) ‚Ä¢ [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](#-–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç) ‚Ä¢ [–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è](#-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è) ‚Ä¢ [–§—É–Ω–∫—Ü–∏–∏](#-–≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ-—Ñ—É–Ω–∫—Ü–∏–∏) ‚Ä¢ [GUI](#-–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å)

</div>

---

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

**DocumentPlaceholder** –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç —à–∞–±–ª–æ–Ω–Ω—ã–µ `.docx`-–¥–æ–∫—É–º–µ–Ω—Ç—ã –≤ –≥–æ—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ YAML-–∫–æ–Ω—Ñ–∏–≥–æ–≤ —Å –º–æ—â–Ω—ã–º —è–∑—ã–∫–æ–º –≤—ã—Ä–∞–∂–µ–Ω–∏–π.

* üìù **Word-—à–∞–±–ª–æ–Ω—ã** ‚Äî –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä—ã `{KEY}` –≤ —Ç–µ–∫—Å—Ç–µ, —Ç–∞–±–ª–∏—Ü–∞—Ö, –∫–æ–ª–æ–Ω—Ç–∏—Ç—É–ª–∞—Ö.
* ‚ö° **–Ø–∑—ã–∫ –≤—ã—Ä–∞–∂–µ–Ω–∏–π** ‚Äî –∞—Ä–∏—Ñ–º–µ—Ç–∏–∫–∞, —Å—Ä–∞–≤–Ω–µ–Ω–∏—è, –≤–ª–æ–∂–µ–Ω–Ω—ã–µ –≤—ã–∑–æ–≤—ã —Ñ—É–Ω–∫—Ü–∏–π, —à–∞–±–ª–æ–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏.
* üõ¢ **SQLite –∏–∑ –∫–æ—Ä–æ–±–∫–∏** ‚Äî –∑–∞–ø—Ä–æ—Å—ã –∫ –±–∞–∑–µ –ø—Ä—è–º–æ –≤ –∫–æ–Ω—Ñ–∏–≥–µ: —Å—á—ë—Ç—á–∏–∫–∏, —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏, –¥–∞–Ω–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç–æ–≤.
* üìÖ **59 –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π** ‚Äî –¥–∞—Ç—ã, —Å—Ç—Ä–æ–∫–∏, –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞, –ª–æ–≥–∏–∫–∞, —É—Å–ª–æ–≤–∏—è.
* üì§ **–≠–∫—Å–ø–æ—Ä—Ç –≤ PDF** ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —á–µ—Ä–µ–∑ LibreOffice.
* üñ• **GUI —Å –ø–æ–¥—Å–≤–µ—Ç–∫–æ–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞** ‚Äî —Ä–µ–¥–∞–∫—Ç–æ—Ä –∫–æ–Ω—Ñ–∏–≥–æ–≤, –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä, SQL-–º–µ–Ω–µ–¥–∂–µ—Ä.
* üîå **–†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å** ‚Äî –¥–æ–±–∞–≤–ª—è–π—Ç–µ —Å–≤–æ–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –æ–¥–Ω–∏–º –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–æ–º.

---

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
pip install document-placeholder
```

**–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**

| Extra | –ß—Ç–æ –≤–∫–ª—é—á–∞–µ—Ç |
|-------|--------------|
| `document-placeholder[gui]` | GUI-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (CustomTkinter) |
| `document-placeholder[dev]` | –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (pytest) |
| `document-placeholder[all]` | –í—Å—ë –≤–º–µ—Å—Ç–µ |

---

## ‚ö° –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –°–æ–∑–¥–∞–π—Ç–µ Word-—à–∞–±–ª–æ–Ω (`template.docx`)

–í—Å—Ç–∞–≤—å—Ç–µ –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä—ã –≤ –¥–æ–∫—É–º–µ–Ω—Ç:

```
Invoice #{INVOICE_NUM}
Date: {DAY_NUM}.{MONTH_STR}.{YEAR_NUM}
Amount: ${PRICE}
{DESCRIPTION}
```

### 2. –ù–∞–ø–∏—à–∏—Ç–µ –∫–æ–Ω—Ñ–∏–≥ (`template.yaml`)

```yaml
ON_START:
  - SQL('CREATE TABLE IF NOT EXISTS doc (num INTEGER DEFAULT 0)')
  - SQL('INSERT OR IGNORE INTO doc (rowid, num) VALUES (1, 0)')

INVOICE_NUM:
  SQL('SELECT num FROM doc WHERE rowid = 1') + 1

MONTH_STR:
  CURRENT_DATE_STR(month)

DAY_NUM:
  CURRENT_DATE_NUM(day)

YEAR_NUM:
  CURRENT_DATE_NUM(year)

PRICE:
  500

DESCRIPTION:
  "Software Development Services
   (Period: {CURRENT_DATE_NUM(day, month, year) - DAYS(7)} ‚Äî {CURRENT_DATE_NUM(day, month, year)})"

OUTPUT_NAME:
  "Invoice-{INVOICE_NUM}"

OUTPUT_FORMAT:
  - docx
  - pdf

ON_END:
  SQL('UPDATE doc SET num = num + 1 WHERE rowid = 1')
```

### 3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ

```bash
docplaceholder -c template.yaml -t template.docx
```

```
  INVOICE_NUM = 2026-2-5
  MONTH_STR = February
  DAY_NUM = 16
  YEAR_NUM = 2026
  PRICE = 500
  DESCRIPTION = Software Development Services (Period: 09.02.2026 ‚Äî 16.02.2026)

  Output: Invoice-2026-2-5 [docx, pdf]
  -> Invoice-2026-2-5.docx
  -> Invoice-2026-2-5.pdf
```

---

## üé® –Ø–∑—ã–∫ –≤—ã—Ä–∞–∂–µ–Ω–∏–π

–ö–æ–Ω—Ñ–∏–≥ ‚Äî —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ –∫–ª—é—á-–∑–Ω–∞—á–µ–Ω–∏–µ. –ö–∞–∂–¥–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ ‚Äî —ç—Ç–æ **–≤—ã—Ä–∞–∂–µ–Ω–∏–µ**, –∫–æ—Ç–æ—Ä–æ–µ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è.

### –ê—Ä–∏—Ñ–º–µ—Ç–∏–∫–∞ –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è

```yaml
TAX: ROUND(PRICE * 0.2, 2)
TOTAL: PRICE + TAX
IS_PREMIUM: TOTAL > 1000
```

### –®–∞–±–ª–æ–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏

–í–Ω—É—Ç—Ä–∏ `"..."` –≤—ã—Ä–∞–∂–µ–Ω–∏—è `{expr}` –ø–æ–¥—Å—Ç–∞–≤–ª—è—é—Ç –≤—ã—á–∏—Å–ª–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è:

```yaml
PERIOD: "{CURRENT_DATE_NUM(day, month, year) - DAYS(30)} ‚Äî {CURRENT_DATE_NUM(day, month, year)}"
```

### –í–ª–æ–∂–µ–Ω–Ω—ã–µ –≤—ã–∑–æ–≤—ã

```yaml
INVOICE_NUM:
  "{CURRENT_DATE_NUM(year)}-{SQL('SELECT num FROM doc WHERE rowid = 1') + 1}"
```

### –£—Å–ª–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞

```yaml
STATUS: IF(TOTAL > 1000, 'Premium', 'Standard')
DISCOUNT: IF(TOTAL >= 500, TOTAL * 0.1, 0)
LABEL: SWITCH(STATUS, 'Premium', '‚≠ê Premium', 'Standard', 'üìã Standard')
```

**–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã:** `+` `-` `*` `/` `%` `>` `<` `>=` `<=` `==` `!=` `()`

---

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### CLI-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã

```
docplaceholder [-c CONFIG] [-t TEMPLATE] [-o OUTPUT] [--db DATABASE]
```

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|-------------|----------|
| `-c, --config` | `template.yaml` | –ü—É—Ç—å –∫ YAML-–∫–æ–Ω—Ñ–∏–≥—É |
| `-t, --template` | `template.docx` | –ü—É—Ç—å –∫ Word-—à–∞–±–ª–æ–Ω—É |
| `-o, --output` | `output.docx` | –ü—É—Ç—å –∫ –≤—ã—Ö–æ–¥–Ω–æ–º—É —Ñ–∞–π–ª—É |
| `--db` | `data.db` | –ü—É—Ç—å –∫ SQLite-–±–∞–∑–µ |
| `-V, --version` | | –í–µ—Ä—Å–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã |

### –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –∫–ª—é—á–∏ YAML

| –ö–ª—é—á | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------|
| `ON_START` | –í—ã—Ä–∞–∂–µ–Ω–∏—è, –≤—ã–ø–æ–ª–Ω—è–µ–º—ã–µ **–¥–æ** –æ–±—Ä–∞–±–æ—Ç–∫–∏ (—Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è) |
| `ON_END` | –í—ã—Ä–∞–∂–µ–Ω–∏—è, –≤—ã–ø–æ–ª–Ω—è–µ–º—ã–µ **–ø–æ—Å–ª–µ** (–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç —Å—á—ë—Ç—á–∏–∫–æ–≤, –æ—á–∏—Å—Ç–∫–∞) |
| `OUTPUT_NAME` | –®–∞–±–ª–æ–Ω –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞: `"Invoice-{INVOICE_NUM}"` |
| `OUTPUT_FORMAT` | –°–ø–∏—Å–æ–∫ —Ñ–æ—Ä–º–∞—Ç–æ–≤: `[docx, pdf]` |

–í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∫–ª—é—á–∏ ‚Äî **–ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä—ã**, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–¥—Å—Ç–∞–≤–ª—è—é—Ç—Å—è –≤ –¥–æ–∫—É–º–µ–Ω—Ç.

---

## üß∞ –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

**59 —Ñ—É–Ω–∫—Ü–∏–π** –≤ 5 –∫–∞—Ç–µ–≥–æ—Ä–∏—è—Ö. –ü–æ–ª–Ω—ã–π —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫: [FUNCTIONS.md](FUNCTIONS.md)

### üìÖ –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è

```yaml
TODAY: TODAY()                                         # 16.02.2026
YEAR: CURRENT_DATE_NUM(year)                           # 2026
MONTH: CURRENT_DATE_STR(month)                         # February
CUSTOM: DATE_FORMAT(DATE(2026, 3, 8), '%d %B %Y')     # 08 March 2026
WEEK_AGO: "{TODAY() - DAYS(7)}"                        # 09.02.2026
DIFF: DAYS_BETWEEN(DATE(2026, 1, 1), TODAY())          # 46
```

### üî§ –°—Ç—Ä–æ–∫–∏

```yaml
UPPER('hello')                    # HELLO
TITLE('john doe')                 # John Doe
PAD_LEFT('42', 6, '0')           # 000042
JOIN(', ', 'a', 'b', 'c')        # a, b, c
REPLACE('foo bar', 'bar', 'baz') # foo baz
SPLIT('user@mail.com', '@', 1)   # mail.com
```

### üî¢ –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞

```yaml
ROUND(19.956, 2)                  # 19.96
FORMAT_NUM(1234567, 2)            # 1,234,567.00
MIN(3, 1, 4, 1, 5)               # 1
AVG(10, 20, 30)                   # 20.0
SQRT(144)                         # 12.0
```

### üß† –õ–æ–≥–∏–∫–∞

```yaml
IF(PRICE > 1000, 'expensive', 'cheap')
COALESCE(SQL('SELECT name FROM clients'), 'Unknown')
DEFAULT(value, 'N/A')
SWITCH(status, 'draft', '–ß–µ—Ä–Ω–æ–≤–∏–∫', 'sent', '–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ', '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ')
```

### üõ¢ SQL

```yaml
SQL('SELECT count(*) FROM orders WHERE user_id = 1')
SQL('INSERT INTO log (event) VALUES ("generated")')
```

---

## üñ• –ì—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

```bash
pip install document-placeholder[gui]
docplaceholder-gui
```

GUI –≤–∫–ª—é—á–∞–µ—Ç:

- **–†–µ–¥–∞–∫—Ç–æ—Ä –∫–æ–Ω—Ñ–∏–≥–æ–≤** —Å –ø–æ–¥—Å–≤–µ—Ç–∫–æ–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ YAML –∏ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–π (`SQL(...)`, `{expressions}`)
- **–ñ–∏–≤–æ–π –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä** –≤—ã—á–∏—Å–ª–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
- **SQL-–º–µ–Ω–µ–¥–∂–µ—Ä** ‚Äî –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤, –ø—Ä–æ—Å–º–æ—Ç—Ä —Ç–∞–±–ª–∏—Ü –∏ —Å—Ö–µ–º—ã
- **–ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏** ‚Äî `Ctrl+S` —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ, `Ctrl+F` –ø–æ–∏—Å–∫, `F5` –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

---

## üîå –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π

–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏—é ‚Äî –æ–¥–∏–Ω –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä:

```python
from document_placeholder.functions import FunctionRegistry

@FunctionRegistry.register("MY_FUNC")
def my_func(arg1, arg2):
    """–í–∞—à–∞ –∫–∞—Å—Ç–æ–º–Ω–∞—è –ª–æ–≥–∏–∫–∞."""
    return f"{arg1}-{arg2}"
```

–ü–æ—Å–ª–µ –∏–º–ø–æ—Ä—Ç–∞ –º–æ–¥—É–ª—è —Ñ—É–Ω–∫—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ –∫–æ–Ω—Ñ–∏–≥–µ:

```yaml
VALUE: MY_FUNC('hello', 'world')   # hello-world
```

---

## üìÅ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–∞–∫ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏

```python
from document_placeholder.config import Config
from document_placeholder.evaluator import Evaluator
from document_placeholder.processor import DocumentProcessor

config = Config.from_string("""
NAME: UPPER('john doe')
DATE: TODAY()
""")

evaluator = Evaluator()
values = {k: evaluator.evaluate_value(v) for k, v in config.placeholders.items()}
# {'NAME': 'JOHN DOE', 'DATE': DateValue(2026-02-16)}

processor = DocumentProcessor("template.docx")
processor.replace_placeholders(values)
processor.save("output.docx")
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
pip install document-placeholder[dev]
pytest
```

```
295 passed in 0.36s
```

---

## ü§ù Contributing

1. –§–æ—Ä–∫–Ω–∏—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
2. –°–æ–∑–¥–∞–π—Ç–µ feature-–≤–µ—Ç–∫—É
3. –ó–∞–∫–æ–º–º–∏—Ç—å—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
4. –û—Ç–∫—Ä–æ–π—Ç–µ Pull Request

–ë–∞–≥–∏ –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è ‚Üí [Issues](https://github.com/FlacSy/DocumentPlaceholder/issues)

---

## üìÑ License

–ü—Ä–æ–µ–∫—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–¥ –ª–∏—Ü–µ–Ω–∑–∏–µ–π **MIT**. –ü–æ–¥—Ä–æ–±–Ω–µ–µ –≤ [LICENSE](LICENSE).

<div align="center">

<sub>Developed with ‚ù§Ô∏è by <a href="https://github.com/FlacSy">FlacSy</a></sub>

</div>
